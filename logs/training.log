2025-09-25 16:48:41,290 - INFO - Setting up for model version: 3
2025-09-25 16:48:41,299 - INFO - Model v3 dataloader args: {'batch_size_train': 64, 'batch_size_test': 1000, 'shuffle_train': True, 'shuffle_test': False, 'train_transforms': Compose(
    RandomRotation(degrees=[-5.0, 5.0], interpolation=nearest, expand=False, fill=(0,))
    RandomAffine(degrees=[0.0, 0.0], translate=(0.03, 0.03))
    ToTensor()
    Normalize(mean=(0.1307,), std=(0.3081,))
), 'test_transforms': Compose(
    ToTensor()
    Normalize(mean=(0.1307,), std=(0.3081,))
)}
2025-09-25 16:48:41,475 - INFO - Model v3: OneCycleLR max_lr=0.065 pct_start=0.1 div_factor=5 final_div_factor=100 epochs=15
2025-09-25 16:48:41,475 - INFO - Dataloader arguments: {'batch_size_train': 64, 'batch_size_test': 1000, 'shuffle_train': True, 'shuffle_test': False, 'train_transforms': Compose(
    RandomRotation(degrees=[-5.0, 5.0], interpolation=nearest, expand=False, fill=(0,))
    RandomAffine(degrees=[0.0, 0.0], translate=(0.03, 0.03))
    ToTensor()
    Normalize(mean=(0.1307,), std=(0.3081,))
), 'test_transforms': Compose(
    ToTensor()
    Normalize(mean=(0.1307,), std=(0.3081,))
)}
2025-09-25 16:48:41,508 - INFO - 
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1            [-1, 4, 28, 28]              36
       BatchNorm2d-2            [-1, 4, 28, 28]               8
              ReLU-3            [-1, 4, 28, 28]               0
            Conv2d-4            [-1, 8, 28, 28]             288
       BatchNorm2d-5            [-1, 8, 28, 28]              16
              ReLU-6            [-1, 8, 28, 28]               0
         MaxPool2d-7            [-1, 8, 14, 14]               0
            Conv2d-8           [-1, 10, 14, 14]             720
       BatchNorm2d-9           [-1, 10, 14, 14]              20
             ReLU-10           [-1, 10, 14, 14]               0
           Conv2d-11           [-1, 16, 14, 14]           1,440
      BatchNorm2d-12           [-1, 16, 14, 14]              32
             ReLU-13           [-1, 16, 14, 14]               0
        MaxPool2d-14             [-1, 16, 7, 7]               0
           Conv2d-15              [-1, 8, 7, 7]             128
      BatchNorm2d-16              [-1, 8, 7, 7]              16
             ReLU-17              [-1, 8, 7, 7]               0
           Conv2d-18             [-1, 16, 7, 7]           1,152
      BatchNorm2d-19             [-1, 16, 7, 7]              32
             ReLU-20             [-1, 16, 7, 7]               0
           Conv2d-21             [-1, 10, 7, 7]             160
      BatchNorm2d-22             [-1, 10, 7, 7]              20
             ReLU-23             [-1, 10, 7, 7]               0
           Conv2d-24             [-1, 10, 5, 5]             900
        AvgPool2d-25             [-1, 10, 1, 1]               0
          Flatten-26                   [-1, 10]               0
================================================================
Total params: 4,968
Trainable params: 4,968
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.00
Forward/backward pass size (MB): 0.39
Params size (MB): 0.02
Estimated Total Size (MB): 0.41
----------------------------------------------------------------
2025-09-25 16:48:41,511 - INFO - Training model for 15 epochs
2025-09-25 16:50:02,618 - INFO - Epoch 01/15: Train set final results: Average loss: 333.8354, Accuracy: 53305/60000 (88.84%)
2025-09-25 16:50:15,496 - INFO - Epoch 01/15:Test set final results: Average loss: 0.0803, Accuracy: 9756/10000 (97.56%)
2025-09-25 16:51:39,769 - INFO - Epoch 02/15: Train set final results: Average loss: 112.6662, Accuracy: 57773/60000 (96.29%)
2025-09-25 16:51:52,147 - INFO - Epoch 02/15:Test set final results: Average loss: 0.0678, Accuracy: 9776/10000 (97.76%)
2025-09-25 16:53:30,369 - INFO - Epoch 03/15: Train set final results: Average loss: 92.0463, Accuracy: 58202/60000 (97.00%)
2025-09-25 16:53:43,684 - INFO - Epoch 03/15:Test set final results: Average loss: 0.0611, Accuracy: 9796/10000 (97.96%)
2025-09-25 16:55:02,104 - INFO - Epoch 04/15: Train set final results: Average loss: 78.9248, Accuracy: 58450/60000 (97.42%)
2025-09-25 16:55:17,882 - INFO - Epoch 04/15:Test set final results: Average loss: 0.0444, Accuracy: 9858/10000 (98.58%)
2025-09-25 16:56:41,128 - INFO - Epoch 05/15: Train set final results: Average loss: 70.1147, Accuracy: 58627/60000 (97.71%)
2025-09-25 16:56:53,202 - INFO - Epoch 05/15:Test set final results: Average loss: 0.0366, Accuracy: 9878/10000 (98.78%)
2025-09-25 16:58:20,740 - INFO - Epoch 06/15: Train set final results: Average loss: 65.8451, Accuracy: 58687/60000 (97.81%)
2025-09-25 16:58:35,805 - INFO - Epoch 06/15:Test set final results: Average loss: 0.0423, Accuracy: 9867/10000 (98.67%)
2025-09-25 17:00:13,944 - INFO - Epoch 07/15: Train set final results: Average loss: 61.2930, Accuracy: 58756/60000 (97.93%)
2025-09-25 17:00:28,863 - INFO - Epoch 07/15:Test set final results: Average loss: 0.0424, Accuracy: 9871/10000 (98.71%)
2025-09-25 17:02:09,064 - INFO - Epoch 08/15: Train set final results: Average loss: 55.5408, Accuracy: 58907/60000 (98.18%)
2025-09-25 17:02:28,979 - INFO - Epoch 08/15:Test set final results: Average loss: 0.0351, Accuracy: 9899/10000 (98.99%)
2025-09-25 17:04:16,749 - INFO - Epoch 09/15: Train set final results: Average loss: 53.4667, Accuracy: 58941/60000 (98.23%)
2025-09-25 17:04:32,518 - INFO - Epoch 09/15:Test set final results: Average loss: 0.0267, Accuracy: 9913/10000 (99.13%)
2025-09-25 17:06:15,861 - INFO - Epoch 10/15: Train set final results: Average loss: 51.1472, Accuracy: 59006/60000 (98.34%)
2025-09-25 17:06:33,657 - INFO - Epoch 10/15:Test set final results: Average loss: 0.0297, Accuracy: 9905/10000 (99.05%)
2025-09-25 17:08:03,222 - INFO - Epoch 11/15: Train set final results: Average loss: 47.4598, Accuracy: 59054/60000 (98.42%)
2025-09-25 17:08:17,633 - INFO - Epoch 11/15:Test set final results: Average loss: 0.0237, Accuracy: 9909/10000 (99.09%)
2025-09-25 17:09:44,341 - INFO - Epoch 12/15: Train set final results: Average loss: 43.2933, Accuracy: 59142/60000 (98.57%)
2025-09-25 17:09:56,987 - INFO - Epoch 12/15:Test set final results: Average loss: 0.0216, Accuracy: 9933/10000 (99.33%)
2025-09-25 17:11:32,564 - INFO - Epoch 13/15: Train set final results: Average loss: 39.8186, Accuracy: 59225/60000 (98.71%)
2025-09-25 17:11:46,560 - INFO - Epoch 13/15:Test set final results: Average loss: 0.0193, Accuracy: 9942/10000 (99.42%)
2025-09-25 17:13:07,724 - INFO - Epoch 14/15: Train set final results: Average loss: 37.5171, Accuracy: 59228/60000 (98.71%)
2025-09-25 17:13:20,396 - INFO - Epoch 14/15:Test set final results: Average loss: 0.0184, Accuracy: 9945/10000 (99.45%)
2025-09-25 17:14:37,387 - INFO - Epoch 15/15: Train set final results: Average loss: 36.9453, Accuracy: 59247/60000 (98.75%)
2025-09-25 17:14:50,037 - INFO - Epoch 15/15:Test set final results: Average loss: 0.0186, Accuracy: 9942/10000 (99.42%)
2025-09-25 17:14:50,040 - INFO - --- Model Architecture Checks ---
2025-09-25 17:14:50,041 - INFO - Total Parameters: 4,968
2025-09-25 17:14:50,041 - INFO - Trainable Parameters: 4,968

2025-09-25 17:14:50,041 - INFO - Layer-wise Parameter Details (in model order):
2025-09-25 17:14:50,041 - INFO - ----------------------------------------------------------------------------------------------------
2025-09-25 17:14:50,041 - INFO - 
Block: input_conv (Sequential)
2025-09-25 17:14:50,041 - INFO -   input_conv.0 (Conv2d)                              | Params:     36 | Convolution: 1->4 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,042 - INFO -   input_conv.1 (BatchNorm2d)                         | Params:      8 | BatchNorm: 4 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,042 - INFO -   input_conv.2 (ReLU)                                | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,042 - INFO -   input_conv.3 (Conv2d)                              | Params:    288 | Convolution: 4->8 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,042 - INFO -   input_conv.4 (BatchNorm2d)                         | Params:     16 | BatchNorm: 8 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,042 - INFO -   input_conv.5 (ReLU)                                | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,042 - INFO -   input_conv.6 (MaxPool2d)                           | Params:      0 | MaxPool: kernel 2, stride 2, padding 0
2025-09-25 17:14:50,042 - INFO - 
Block: feature_block (Sequential)
2025-09-25 17:14:50,042 - INFO -   feature_block.0 (Conv2d)                           | Params:    720 | Convolution: 8->10 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,042 - INFO -   feature_block.1 (BatchNorm2d)                      | Params:     20 | BatchNorm: 10 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,042 - INFO -   feature_block.2 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,042 - INFO -   feature_block.3 (Conv2d)                           | Params:  1,440 | Convolution: 10->16 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,044 - INFO -   feature_block.4 (BatchNorm2d)                      | Params:     32 | BatchNorm: 16 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,044 - INFO -   feature_block.5 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,044 - INFO -   feature_block.6 (MaxPool2d)                        | Params:      0 | MaxPool: kernel 2, stride 2, padding 0
2025-09-25 17:14:50,044 - INFO - 
Block: pattern_block (Sequential)
2025-09-25 17:14:50,044 - INFO -   pattern_block.0 (Conv2d)                           | Params:    128 | Convolution: 16->8 channels, kernel (1, 1), stride (1, 1), padding (0, 0), groups 1, bias False
2025-09-25 17:14:50,044 - INFO -   pattern_block.1 (BatchNorm2d)                      | Params:     16 | BatchNorm: 8 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,044 - INFO -   pattern_block.2 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,044 - INFO -   pattern_block.3 (Conv2d)                           | Params:  1,152 | Convolution: 8->16 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,044 - INFO -   pattern_block.4 (BatchNorm2d)                      | Params:     32 | BatchNorm: 16 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,044 - INFO -   pattern_block.5 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,044 - INFO - 
Block: classifier (Sequential)
2025-09-25 17:14:50,045 - INFO -   classifier.0 (Conv2d)                              | Params:    160 | Convolution: 16->10 channels, kernel (1, 1), stride (1, 1), padding (0, 0), groups 1, bias False
2025-09-25 17:14:50,045 - INFO -   classifier.1 (BatchNorm2d)                         | Params:     20 | BatchNorm: 10 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,045 - INFO -   classifier.2 (ReLU)                                | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,045 - INFO -   classifier.3 (Conv2d)                              | Params:    900 | Convolution: 10->10 channels, kernel (3, 3), stride (1, 1), padding (0, 0), groups 1, bias False
2025-09-25 17:14:50,045 - INFO -   classifier.4 (AvgPool2d)                           | Params:      0 | AvgPool: kernel 5, stride 5, padding 0
2025-09-25 17:14:50,045 - INFO -   classifier.5 (Flatten)                             | Params:      0 | Flatten
2025-09-25 17:14:50,045 - INFO - ----------------------------------------------------------------------------------------------------
2025-09-25 17:14:50,045 - INFO - 
Layer Type Summary:
2025-09-25 17:14:50,046 - INFO - Conv2d               layers used:   8
2025-09-25 17:14:50,046 - INFO - BatchNorm2d          layers used:   7
2025-09-25 17:14:50,046 - INFO - ReLU                 layers used:   7
2025-09-25 17:14:50,046 - INFO - MaxPool2d            layers used:   2
2025-09-25 17:14:50,046 - INFO - AvgPool2d            layers used:   1
2025-09-25 17:14:50,047 - INFO - Flatten              layers used:   1
2025-09-25 17:14:50,047 - INFO - ----------------------------------------------------------------------------------------------------
2025-09-25 17:14:50,047 - INFO - 
2025-09-25 17:14:50,040 - INFO - --- Model Architecture Checks ---
2025-09-25 17:14:50,041 - INFO - Total Parameters: 4,968
2025-09-25 17:14:50,041 - INFO - Trainable Parameters: 4,968

2025-09-25 17:14:50,041 - INFO - Layer-wise Parameter Details (in model order):
2025-09-25 17:14:50,041 - INFO - ----------------------------------------------------------------------------------------------------
2025-09-25 17:14:50,041 - INFO - 
Block: input_conv (Sequential)
2025-09-25 17:14:50,041 - INFO -   input_conv.0 (Conv2d)                              | Params:     36 | Convolution: 1->4 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,042 - INFO -   input_conv.1 (BatchNorm2d)                         | Params:      8 | BatchNorm: 4 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,042 - INFO -   input_conv.2 (ReLU)                                | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,042 - INFO -   input_conv.3 (Conv2d)                              | Params:    288 | Convolution: 4->8 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,042 - INFO -   input_conv.4 (BatchNorm2d)                         | Params:     16 | BatchNorm: 8 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,042 - INFO -   input_conv.5 (ReLU)                                | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,042 - INFO -   input_conv.6 (MaxPool2d)                           | Params:      0 | MaxPool: kernel 2, stride 2, padding 0
2025-09-25 17:14:50,042 - INFO - 
Block: feature_block (Sequential)
2025-09-25 17:14:50,042 - INFO -   feature_block.0 (Conv2d)                           | Params:    720 | Convolution: 8->10 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,042 - INFO -   feature_block.1 (BatchNorm2d)                      | Params:     20 | BatchNorm: 10 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,042 - INFO -   feature_block.2 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,042 - INFO -   feature_block.3 (Conv2d)                           | Params:  1,440 | Convolution: 10->16 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,044 - INFO -   feature_block.4 (BatchNorm2d)                      | Params:     32 | BatchNorm: 16 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,044 - INFO -   feature_block.5 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,044 - INFO -   feature_block.6 (MaxPool2d)                        | Params:      0 | MaxPool: kernel 2, stride 2, padding 0
2025-09-25 17:14:50,044 - INFO - 
Block: pattern_block (Sequential)
2025-09-25 17:14:50,044 - INFO -   pattern_block.0 (Conv2d)                           | Params:    128 | Convolution: 16->8 channels, kernel (1, 1), stride (1, 1), padding (0, 0), groups 1, bias False
2025-09-25 17:14:50,044 - INFO -   pattern_block.1 (BatchNorm2d)                      | Params:     16 | BatchNorm: 8 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,044 - INFO -   pattern_block.2 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,044 - INFO -   pattern_block.3 (Conv2d)                           | Params:  1,152 | Convolution: 8->16 channels, kernel (3, 3), stride (1, 1), padding (1, 1), groups 1, bias False
2025-09-25 17:14:50,044 - INFO -   pattern_block.4 (BatchNorm2d)                      | Params:     32 | BatchNorm: 16 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,044 - INFO -   pattern_block.5 (ReLU)                             | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,044 - INFO - 
Block: classifier (Sequential)
2025-09-25 17:14:50,045 - INFO -   classifier.0 (Conv2d)                              | Params:    160 | Convolution: 16->10 channels, kernel (1, 1), stride (1, 1), padding (0, 0), groups 1, bias False
2025-09-25 17:14:50,045 - INFO -   classifier.1 (BatchNorm2d)                         | Params:     20 | BatchNorm: 10 features, eps=1e-05, momentum=0.1
2025-09-25 17:14:50,045 - INFO -   classifier.2 (ReLU)                                | Params:      0 | Activation: ReLU
2025-09-25 17:14:50,045 - INFO -   classifier.3 (Conv2d)                              | Params:    900 | Convolution: 10->10 channels, kernel (3, 3), stride (1, 1), padding (0, 0), groups 1, bias False
2025-09-25 17:14:50,045 - INFO -   classifier.4 (AvgPool2d)                           | Params:      0 | AvgPool: kernel 5, stride 5, padding 0
2025-09-25 17:14:50,045 - INFO -   classifier.5 (Flatten)                             | Params:      0 | Flatten
2025-09-25 17:14:50,045 - INFO - ----------------------------------------------------------------------------------------------------
2025-09-25 17:14:50,045 - INFO - 
Layer Type Summary:
2025-09-25 17:14:50,046 - INFO - Conv2d               layers used:   8
2025-09-25 17:14:50,046 - INFO - BatchNorm2d          layers used:   7
2025-09-25 17:14:50,046 - INFO - ReLU                 layers used:   7
2025-09-25 17:14:50,046 - INFO - MaxPool2d            layers used:   2
2025-09-25 17:14:50,046 - INFO - AvgPool2d            layers used:   1
2025-09-25 17:14:50,047 - INFO - Flatten              layers used:   1
2025-09-25 17:14:50,047 - INFO - ----------------------------------------------------------------------------------------------------
